<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <link rel="icon" href="/LCRSystem/image/LCRlogo.png" type="image/png" sizes="32x32">
<link rel="apple-touch-icon" href="/LCRSystem/image/LCRlogo.png">
<meta name="theme-color" content="#415D8A">
  <title>Validate Marriage</title>
  <link rel="stylesheet" href="style/styles.css">

  <style>
    :root{
      --blue-100:#D0E1F5; --blue-200:#A8BCDA; --blue-700:#415D8A;
      --white:#FFFFFF; --text:#1e293b;
      --slate-100:#f1f5f9; --slate-200:#e2e8f0; --slate-300:#cbd5e1; --slate-700:#334155;
      --green-600:#16a34a; --green-700:#15803d; --red-600:#dc2626; --red-700:#b91c1c;
      --violet-600:#7c3aed; --violet-700:#6d28d9;
    }

    body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;background:#fff;color:var(--text);}

    /* Page header */
    .page-header { margin: 24px 16px 18px; }
    .page-header h1 { font-size: 28px; margin: 0 0 4px; color: var(--text); }
    .page-header .subtitle { margin: 0; color: var(--slate-700); }

    /* Table shell */
    .table-wrap { margin: 0 16px 24px; background: var(--white); border:1px solid var(--slate-200); border-radius: 8px; overflow: hidden; }
    .reg-table { width: 100%; border-collapse: collapse; table-layout: fixed; background: var(--white); }
    .reg-table thead th {
      text-align: left; font-weight: 600; color: var(--slate-700);
      background: var(--slate-100); border-bottom: 1px solid var(--slate-200);
      padding: 12px 14px; font-size: 14px;
    }
    .reg-table td { padding: 14px; vertical-align: middle; border-top: 1px solid var(--slate-200); border-left: 1px solid var(--slate-200); }
    .reg-table td:first-child { border-left: none; }
    .reg-table tr:last-child td { border-bottom: none; }

    /* Name cell */
    .name-cell .name { font-weight: 600; color: var(--text); }
    .name-cell .muted { color: #64748b; font-size: 13px; }

    /* Link icon */
    .requirements, .link-icon { display: inline-flex; align-items: center; }
    .link-icon {
      border: 1px solid var(--slate-300);
      background: var(--white);
      padding: 8px; border-radius: 8px; cursor: pointer; color: var(--slate-700);
    }
    .link-icon:hover { background: var(--slate-100); }

    /* Buttons */
    .btn { border: 1px solid transparent; border-radius: 10px; padding: 10px 14px; font-weight: 600; cursor: pointer; font-size: 14px; display: inline-flex; align-items: center; gap: 8px; }
    .btn .btn-icon { font-weight: 700; }
    .btn.primary { background: var(--blue-700); color: #fff; }
    .btn.primary:hover { background: #3a537c; }
    .btn.success { background: var(--green-600); color: #fff; }
    .btn.success:hover { background: var(--green-700); }
    .btn.success.outline { background: #eaf7ef; color: var(--green-700); border-color: #b7e0c3; }
    .btn.danger { background: var(--red-600); color: #fff; }
    .btn.danger.ghost { background: #fff; color: var(--red-700); border-color: #fecaca; }
    .btn.sm { padding: 6px 10px; font-size: 13px; border-radius: 8px; }

    /* Inline actions */
    .actions-inline { display: inline-flex; gap: 8px; }

    /* Stack */
    .stack-gap-6 { display: grid; gap: 6px; }

    /* Badges */
    .badge { display:inline-flex; align-items:center; padding: 4px 8px; border-radius: 999px; font-size: 12px; font-weight: 600; }
    .badge.ok { background: #e8f5ee; color: var(--green-700); border: 1px solid #b7e0c3; }
    .badge.pending { background: #f1f5ff; color: #1e40af; border: 1px solid #c7d2fe; }
    .badge.reject { background: #fff1f2; color: var(--red-700); border: 1px solid #fecdd3; }

    /* Actions column links */
    .action-links { display: grid; gap: 8px; }
    .action { display:inline-flex; align-items:center; gap: 6px; text-decoration: none; font-weight: 600; color: var(--blue-700); }
    .action .action-icon { font-size: 14px; }
    .action:hover { text-decoration: underline; }
    .action.violet { color: var(--violet-700); }

    /* Dialogs (requirements & validate registration) */
    .req-dialog {
      width: 900px; max-width: 95vw;
      margin: auto; padding: 0;
      border: 1px solid var(--slate-300);
      border-radius: 12px;
    }
    .req-dialog::backdrop { background: rgba(0,0,0,.35); }

    .req-dialog header{
      display:flex; align-items:center; justify-content:space-between;
      padding:12px 14px; background:var(--slate-100); border-bottom:1px solid var(--slate-200);
    }
    .req-dialog h3{ margin:0; font-size:16px; color:var(--text); }
    .icon.ghost { background: transparent; border: none; font-size: 16px; cursor: pointer; color: var(--slate-700); }
    .icon.ghost:hover { opacity: .8; }

    /* Table-like content inside dialogs */
    .req-table{ width:100%; border:1px solid var(--slate-200); border-radius:10px; overflow:hidden; }
    .req-thead{ display:grid; grid-template-columns:1.4fr 1fr 1.4fr; background:var(--slate-100); }
    .req-th{ padding:10px 12px; font-weight:700; color:var(--slate-700); border-right:1px solid var(--slate-200); text-align:center; }
    .req-th:last-child{ border-right:none; }
    .req-tbody{ list-style:none; margin:0; padding:0; }
    .req-tr{ display:grid; grid-template-columns:1.4fr 1fr 1.4fr; }
    .req-td{
      padding:12px; background:#fff;
      border-top:1px solid var(--slate-200); border-right:1px solid var(--slate-200);
    }
    .req-td:last-child{ border-right:none; }
    .req-title{ font-weight:600; color:var(--text); display:flex; align-items:center; }
    .req-td .actions-inline{ display:inline-flex; gap:10px; justify-content:center; width:100%; }
    .note-form{ display:grid; gap:8px; justify-items:center; }
    .note-input{ width:100%; border:1px solid var(--slate-300); border-radius:8px; padding:8px 10px; font:inherit; resize:vertical; }
    .req-td:has(.note-form[hidden]){ background:#fff; }

    /* Big modal for the registration form */
    .form-dialog {
      width: 95vw; max-width: 1200px;
      height: 92vh; max-height: 92vh;
      margin: auto; padding: 0;
      border: 1px solid var(--slate-300);
      border-radius: 12px;
    }
    .form-dialog::backdrop { background: rgba(0,0,0,.45); }
    .form-dialog__bar{
      display:flex; align-items:center; justify-content:space-between;
      gap: 12px; padding: 10px 12px; background: var(--slate-100); border-bottom: 1px solid var(--slate-200);
    }
    .form-dialog__bar h3{ margin:0; font-size:16px; color:var(--text); }
    .form-dialog__actions{ display:flex; gap:8px; }
    .form-dialog__host{ width: 100%; height: calc(92vh - 50px); background:#fff; }
    .form-dialog__host iframe{ width: 100%; height: 100%; border: 0; background: #fff; }

    /* 2-column app layout so content sits beside the sidebar */
    .app{
      display: grid;
      grid-template-columns: 260px 1fr;
      min-height: 100dvh;
    }
    .content{ padding: 16px 16px 24px; }
    .sidebar{ width: 260px; }

    /* optional: scale down on small screens */
    @media (max-width:1024px){
      .page-header .page-title{ font-size:56px; }
      .page-header .subtitle{ font-size:32px; }
    }
    @media (max-width:640px){
      .page-header .page-title{ font-size:40px; }
      .page-header .subtitle{ font-size:22px; }
    }

    /* huge header + subheader */
    .page-header .page-title{
      font-size: 58px;
      line-height: 1.05;
      font-weight: 800;
      margin: 0;
      color: var(--text);
    }
    .page-header .subtitle{
      font-size: 28px;
      line-height: 1.1;
      font-weight: 600;
      margin: 6px 0 0;
      color: var(--slate-700);
    }

    .typewriter{
      display: inline-block;
      white-space: nowrap;
      overflow: hidden;
      border-right: 2px solid transparent;  /* caret */
      padding-right: .1em;
      --tw-chars: 0;
      --tw-duration: 3s;
    }
    .typewriter.animating{
      border-right-color: #415D8A;   /* caret color */
      animation: typing var(--tw-duration) steps(var(--tw-chars), end) forwards;
    }
    @keyframes typing{
      from{ width: 0 }
      to  { width: calc(var(--tw-chars) * 1ch) }
    }

    /* ‚Äî‚Äî‚Äî Search toolbar (right-aligned) ‚Äî‚Äî‚Äî */
    .val-toolbar{
      display:flex; justify-content:flex-end; align-items:center;
      gap:.6rem; margin:.35rem 16px .6rem; /* align with page margins */
    }
    .val-search{ position:relative; width:min(360px, 100%); }
    .val-search input{
      width:100%; height:2.2rem; padding:.45rem 2.2rem .45rem .65rem;
      border:1px solid var(--slate-300); border-radius:8px; outline:none;
      font:inherit;
    }
    .val-search svg{
      position:absolute; right:.5rem; top:50%; transform:translateY(-50%);
      width:18px; height:18px; opacity:.7; pointer-events:none;
    }
    @media print{ .val-toolbar{ display:none; } }
   


  </style>
</head>

<body>

<div class="app">
  <aside class="sidebar" data-collapsed="false">
    <div class="brand">
      <div class="logo">
        <img src="image/LCRlogo.png" alt="LCR Logo">
      </div>
      <div class="name">
        Civil<span class="accent">.Registry</span>
      </div>
      <p class="tagline">Civil Registry Management System</p>
    </div>

    <nav class="nav" role="navigation">
      <div class="nav__section">Main</div>
      <a href="staffPanel.html" class="nav__link " aria-current="page" title="Home">
        <span class="nav__icon" aria-hidden="true">üè†</span>
        <span class="nav__label">Home</span>
      </a>
      <a href="validateDashboard.html" class="nav__link " title="Dashboard">
        <span class="nav__icon" aria-hidden="true">üìä</span>
        <span class="nav__label">Dashboard</span>
      </a>

      <div class="nav__section">Validations</div>
      <a href="validateBirth.html" class="nav__link" title="Validate Birth">
        <span class="nav__icon" aria-hidden="true">üë∂</span>
        <span class="nav__label">Validate Birth</span>
      </a>
      <a href="validateDeath.html" class="nav__link" title="Validate Death">
        <span class="nav__icon" aria-hidden="true">üïäÔ∏è</span>
        <span class="nav__label">Validate Death</span>
      </a>
      <a href="validateMarriage.html" class="nav__link is-active" title="Validate Marriage">
        <span class="nav__icon" aria-hidden="true">üíç</span>
        <span class="nav__label">Validate Marriage</span>
      </a>
    </nav>
  </aside>

  <main class="content">
    <section class="page-header">
      <h1 class="page-title">
        <span class="typewriter">Marriage Registration Validation</span>
      </h1>
      <p class="subtitle">Review and validate registration applications</p>

      <br><br><br><br>

      <!-- ===== Search toolbar (right aligned) ===== -->
      <div class="val-toolbar">
        <label class="val-search" aria-label="Search registrations">
          <input id="val-search" type="search" placeholder="Search" />
          <svg viewBox="0 0 24 24" aria-hidden="true">
            <path d="M15.5 14h-.79l-.28-.27A6.471 6.471 0 0 0 16 9.5 6.5 6.5 0 1 0 9.5 16a6.471 6.471 0 0 0 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"></path>
          </svg>
        </label>
      </div>

      <div class="table-wrap">
        <table class="reg-table">
          <colgroup>
  <col style="width: 16%">
  <col style="width: 15%">
  <col style="width: 12%">
  <col style="width: 15%">
  <col style="width: 13%">
  <col style="width: 18%">
  <col style="width: 17%">
</colgroup>
          <thead>
            <tr>
              <th>Name</th>
              <th>Validate Requirements</th>
              <th>Status</th>
              <th>Validate Registration</th>
              <th>Final Status</th>
              <th>Attach File/Scan QR CODE</th>
              <th>View Final Attachment</th>            
            </tr>
          </thead>

          <!-- BODY now has an ID for filtering -->
          <tbody id="val-body">
            <tr>
              <!-- NAME -->
              <td>
                <div class="name-cell">
                  <div class="name">Jouselo Nakila</div>
                  <div class="muted">jouselo@gmail.com</div>                
                </div>
              </td>

              <!-- VALIDATE REQUIREMENTS -->
              <td>
                <div class="requirements">
                  <button class="link-icon" data-open="req-1" aria-label="View requirements">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true">
                      <path d="M10.59 13.41a2 2 0 0 0 2.82 0l3.59-3.59a2 2 0 1 0-2.82-2.82l-1.18 1.18" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"/>
                      <path d="M13.41 10.59a2 2 0 0 0-2.82 0L7 14.18a2 2 0 1 0 2.82 2.82l1.18-1.18" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                  </button>

                  <!-- Requirements dialog -->
                  <dialog id="req-1" class="req-dialog">
                    <header>
                      <h3>Uploaded Requirements</h3>
                      <button class="icon ghost" data-close aria-label="Close">‚úï</button>
                    </header>

                    <div class="req-table">
                      <div class="req-thead">
                        <div class="req-th">Requirement</div>
                        <div class="req-th">Actions</div>
                        <div class="req-th">Revise with Notes</div>
                      </div>

                      <ul class="req-tbody">
                        <li class="req-tr">
                          <span class="req-td req-title">Birth Certificate of Contracting Parties</span>
                          <div class="req-td">
                            <div class="actions-inline">
                              <button class="btn sm success" data-approve>Approve</button>
                              
                            </div>
                          </div>
                          <div class="req-td">
                            <form class="note-form" hidden>
                              <textarea class="note-input" rows="3" placeholder="Add a short note explaining what to revise..."></textarea>
                              <button class="btn sm primary" data-send-revision>Send for Revision</button>
                            </form>
                          </div>
                        </li>

                        <li class="req-tr">
                          <span class="req-td req-title">Certificate of No Marriage(CENOMAR)</span>
                          <div class="req-td">
                            <div class="actions-inline">
                              <button class="btn sm success" data-approve>Approve</button>
                              
                            </div>
                          </div>
                          <div class="req-td">
                            <form class="note-form" hidden>
                              <textarea class="note-input" rows="3" placeholder="Add a short note explaining what to revise..."></textarea>
                              <button class="btn sm primary" data-send-revision>Send for Revision</button>
                            </form>
                          </div>
                        </li>

                        <li class="req-tr">
                          <span class="req-td req-title">Brgy. Certification of Residency</span>
                          <div class="req-td">
                            <div class="actions-inline">
                              <button class="btn sm success" data-approve>Approve</button>
                             
                            </div>
                          </div>
                          <div class="req-td">
                            <form class="note-form" hidden>
                              <textarea class="note-input" rows="3" placeholder="Add a short note explaining what to revise..."></textarea>
                              <button class="btn sm primary" data-send-revision>Send for Revision</button>
                            </form>
                          </div>
                        </li>

                        <li class="req-tr">
                          <span class="req-td req-title">Pre-Marriage Counseling Certificate</span>
                          <div class="req-td">
                            <div class="actions-inline">
                              <button class="btn sm success" data-approve>Approve</button>
                             
                            </div>
                          </div>
                          <div class="req-td">
                            <form class="note-form" hidden>
                              <textarea class="note-input" rows="3" placeholder="Add a short note explaining what to revise..."></textarea>
                              <button class="btn sm primary" data-send-revision>Send for Revision</button>
                            </form>
                          </div>
                        </li>

                        <li class="req-tr">
                          <span class="req-td req-title"> Certificate of Compliance</span>
                          <div class="req-td">
                            <div class="actions-inline">
                              <button class="btn sm success" data-approve>Approve</button>
                             
                            </div>
                          </div>
                          <div class="req-td">
                            <form class="note-form" hidden>
                              <textarea class="note-input" rows="3" placeholder="Add a short note explaining what to revise..."></textarea>
                              <button class="btn sm primary" data-send-revision>Send for Revision</button>
                            </form>
                          </div>
                        </li>

                           <li class="req-tr">
                          <span class="req-td req-title"> Government Issued ID's</span>
                          <div class="req-td">
                            <div class="actions-inline">
                              <button class="btn sm success" data-approve>Approve</button>
                             
                            </div>
                          </div>
                          <div class="req-td">
                            <form class="note-form" hidden>
                              <textarea class="note-input" rows="3" placeholder="Add a short note explaining what to revise..."></textarea>
                              <button class="btn sm primary" data-send-revision>Send for Revision</button>
                            </form>
                          </div>
                        </li>


                      </ul>
                    </div>
                  </dialog>
                </div>
              </td>

              <!-- STATUS -->
              <td>
                <div class="stack-gap-6" data-status>
                  <span class="badge pending">1/6 Approved</span>
                </div>
              </td>

              <!-- VALIDATE REGISTRATION (same UI as requirements) -->
              <td>
                <div class="validate-registration">
                  <button class="link-icon" data-open="reg-1" aria-label="View registration details">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true">
                      <path d="M10.59 13.41a2 2 0 0 0 2.82 0l3.59-3.59a2 2 0 1 0-2.82-2.82l-1.18 1.18" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"/>
                      <path d="M13.41 10.59a2 2 0 0 0-2.82 0L7 14.18a2 2 0 1 0 2.82 2.82l1.18-1.18" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                  </button>
                </div>

                <dialog id="reg-1" class="req-dialog">
                  <header>
                    <h3>Validate Marriage Registration Form</h3>
                    <button class="icon ghost" data-close aria-label="Close">‚úï</button>
                  </header>

                  <div class="req-table">
                    <div class="req-thead">
                      <div class="req-th">Field</div>
                      <div class="req-th">Actions</div>
                      <div class="req-th">Revise with Notes</div>
                    </div>

                    <ul class="req-tbody">
                      <li class="req-tr">
                        <span class="req-td req-title">Marriage Application Form: Marriage Certificate Form</span>
                        <div class="req-td">
                          <div class="actions-inline">
                            <button class="btn sm success" data-approve>Approve</button>
                          
                          </div>
                        </div>
                        <div class="req-td">
                          <form class="note-form" hidden>
                            <textarea class="note-input" rows="3" placeholder="Add note for revision..."></textarea>
                            <button class="btn sm primary" data-send-revision>Send for Revision</button>
                          </form>
                        </div>
                      </li>

                      
                    </ul>
                  </div>
                </dialog>
              </td>

              <!-- FINAL STATUS -->
              <td>
                <div class="stack-gap-6" data-status-final>
                  <span class="badge pending">Pending</span>
                </div>
              </td>

             <td>
  <div class="action-links">
    <span id="qrText" class="qr-text">Tap to Capture Document</span>
    <div id="qrPopup" class="qr-popup">
      <canvas id="qrCode" class="qr-canvas"></canvas>
      <button id="closeBtn">Close</button>
    </div>
  </div>
</td>

<!-- Scripts -->
<script src="https://cdn.jsdelivr.net/npm/qrcode/build/qrcode.min.js"></script>
<script>
  const recordId = "LCR-001";
  const uploadURL = `https://example.com/upload?id=${recordId}`;

  const qrCanvas = document.getElementById("qrCode");
  const qrText = document.getElementById("qrText");
  const qrPopup = document.getElementById("qrPopup");
  const closeBtn = document.getElementById("closeBtn");

  // Generate QR
  QRCode.toCanvas(qrCanvas, uploadURL, {
    width: 220,
    margin: 2,
    color: { dark: "#000", light: "#fff" }
  });

  // Show QR popup
  qrText.addEventListener("click", () => {
    qrPopup.classList.add("active");
  });

  // Close popup
  closeBtn.addEventListener("click", () => {
    qrPopup.classList.remove("active");
  });
</script>

<style>
  .qr-text {
    font-size: 15px;
    color: #007bff;
    cursor: pointer;
    text-decoration: underline;
    transition: color 0.2s;
  }

  .qr-text:hover {
    color: #0056b3;
  }

  /* Popup overlay */
  .qr-popup {
    position: fixed;
    inset: 0;
    background: rgba(0, 0, 0, 0.8);
    display: none;
    justify-content: center;
    align-items: center;
    flex-direction: column;
    z-index: 9999;
  }

  .qr-popup.active {
    display: flex;
  }

  .qr-canvas {
    background: white;
    padding: 20px;
    border-radius: 12px;
    box-shadow: 0 0 20px rgba(255, 255, 255, 0.3);
  }

  #closeBtn {
    margin-top: 20px;
    background: #dc3545;
    color: white;
    border: none;
    padding: 8px 16px;
    border-radius: 8px;
    cursor: pointer;
    transition: background 0.2s;
  }

  #closeBtn:hover {
    background: #c82333;
  }

  .action-links {
    display: flex;
    justify-content: center;
    align-items: center;
  }
</style>


              <td>
                <div class="action-links">
                  <a href="#" class="action violet" data-open-form="form-1">
                    <span class="action-icon">üìù</span> View Registration Form
                  </a>
                </div>
              </td>

            </tr>

             


          </tbody>

          <!-- Empty state body (shown when search has no matches) -->
          <tbody id="val-empty" style="display:none">
            <tr>
              <td colspan="6" style="padding:12px 14px;color:#64748b">No matching registrations.</td>
            </tr>
          </tbody>
        </table>
      </div>
    </section>
  </main>
</div>

<!-- Registration Form Modal -->
<dialog id="form-1" class="form-dialog">
  <header class="form-dialog__bar">
    <h3>Registration Form ‚Äì Certificate of Live Birth</h3>
    <div class="form-dialog__actions">
      <button class="btn sm primary" data-print>Print</button>
      <button class="btn sm danger ghost" data-close aria-label="Close">Close ‚úï</button>
    </div>
  </header>
  <div class="form-dialog__host">
    <iframe id="regFormFrame-1"
            title="Certificate of Live Birth"
            sandbox="allow-same-origin allow-forms allow-scripts allow-popups allow-modals"></iframe>
  </div>
</dialog>

<!-- ===== The full birth form HTML is stored in this template and injected into the iframe ===== -->
<template id="birth-form-template">
  <!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
 
 <link rel="icon" href="/LCRSystem/image/LCRlogo.png" type="image/png" sizes="32x32">
<link rel="apple-touch-icon" href="/LCRSystem/image/LCRlogo.png">
<meta name="theme-color" content="#415D8A">
  <title>Application for Marriage License ‚Äî Republic of the Philippines</title>

  <!-- Font substitutes: Merriweather (serif) for headings, Inter (sans-serif) for labels/body -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=Merriweather:wght@700;900&display=swap" rel="stylesheet">

  <style>
    :root{
      --ink:#111; --ink-faint:#444; --border:#222; --hair:#6a6a6a; --paper:#fff;
      --title-size: clamp(18px, 2.4vw, 26px);
      --label-size: clamp(11px, 1.25vw, 13px);
      --mini-size: clamp(10px, 1.1vw, 12px);
      --body-size: clamp(12px, 1.35vw, 14px);
      --rule: 1px; --hairline: 0.6px;
      --err:#c62828; --err-bg:rgba(198,40,40,.06);
    }
    *{box-sizing:border-box}
    html,body{height:100%;background:var(--paper);color:var(--ink);}
    body{margin:0;font:var(--body-size) "Inter", system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Noto Sans", "Liberation Sans", sans-serif;}

    .smallcaps{letter-spacing:.04em;text-transform:uppercase;font-weight:600}
    .mini{font-size:var(--mini-size);color:var(--ink-faint)}
    .center{text-align:center}
    .right{text-align:right}
    .just{text-align:justify}

    .sheet{
      margin:0 auto;
      max-width:980px;
      padding:clamp(12px, 2vw, 18px);
      border:var(--rule) solid var(--border);
      box-shadow:0 2px 0 rgba(0,0,0,.03) inset;
      position:relative;
    }
    .A4{aspect-ratio:auto;}

    .masthead{display:grid;grid-template-columns:1fr 2fr 1fr;gap:8px;align-items:end;margin-bottom:8px}
    .masthead__left,.masthead__right{align-self:start}
    .masthead .title{
      font-family:"Merriweather", Georgia, serif;font-weight:900;text-align:center;margin:4px 0 0;
      font-size:var(--title-size);border-top:var(--hairline) solid var(--hair);padding-top:6px
    }
    .masthead .gov,.masthead .office{font-size:var(--mini-size);text-align:center}
    .masthead .mini{font-size:var(--mini-size)}

    .meta-grid{
      display:grid;
      grid-template-columns:repeat(5,minmax(0,1fr));
      gap:6px;border-top:var(--rule) solid var(--border);border-bottom:var(--rule) solid var(--border);
      padding:6px 4px;margin-bottom:8px
    }
    .meta{border:var(--hairline) solid var(--hair);height:34px;padding:2px 6px;display:flex;flex-direction:column;justify-content:flex-end}
    .meta label{font-size:var(--mini-size);color:var(--ink-faint);line-height:1}
    .meta input{border:0;border-top:var(--hairline) solid transparent;outline:none;font-size:12px;padding:2px 0 0;min-height:16px;width:100%;}

    @media (max-width:1024px){ .meta-grid{grid-template-columns:repeat(3,minmax(0,1fr));} }
    @media (max-width:700px){ .meta-grid{grid-template-columns:repeat(2,minmax(0,1fr));} }
    @media (max-width:480px){ .meta-grid{grid-template-columns:1fr;} }

    .twocol{display:grid;grid-template-columns:1fr;gap:8px}
    @media (min-width:900px){ .twocol{grid-template-columns:1fr 1fr;} }

    .panel{border:var(--rule) solid var(--border);padding:6px 8px;display:flex;flex-direction:column;gap:6px;min-height:100%}
    .panel__title{font-weight:700;border-bottom:var(--rule) solid var(--border);padding:4px;text-align:center;background:#f7f7f7}
    .registrar-note{border-bottom:var(--hairline) solid var(--hair);padding-bottom:6px}

    .fieldset{list-style:none;margin:0;padding:0;display:flex;flex-direction:column;gap:6px}
    .row-title{font-weight:600;font-size:var(--label-size);margin-bottom:2px}
    .grid-1,.grid-2,.grid-3,.grid-4{display:grid;gap:6px}
    .grid-1{grid-template-columns:1fr}
    .grid-2{grid-template-columns:1fr 1fr}
    .grid-3{grid-template-columns:1fr 1fr 1fr}
    .grid-4{grid-template-columns:repeat(4,1fr)}
    .stack-on-mobile{grid-template-columns:1fr}
    @media (min-width:640px){
      .stack-on-mobile.grid-3{grid-template-columns:repeat(3,1fr)}
      .stack-on-mobile.grid-4{grid-template-columns:repeat(4,1fr)}
      .stack-on-mobile.grid-2{grid-template-columns:repeat(2,1fr)}
    }

    /* Field container */
    .field{ position:relative; padding-bottom:8px; }
    .field input,
    .field select,
    .field textarea{
      width:100%; border:var(--hairline) solid var(--hair);
      height:28px; padding:4px 6px; font-size:12px; background:#fff; outline:none;
    }
    .field.small input, .field.small select{height:24px}

    /* Bigger tap targets on mobile */
    @media (max-width:640px){
      .field input, .field select, .field textarea{ height:40px; font-size:14px; }
      .field.small input, .field.small select{ height:36px; }
    }

    /* Hint labels */
    .hint{
      position:absolute; top:50%; left:8px; transform:translateY(-50%);
      font-size:var(--mini-size); color:var(--ink-faint); pointer-events:none;
      transition: top .15s ease, transform .15s ease, opacity .15s ease;
      line-height:1; z-index:0;
    }
    .field.has-value .hint,
    .field :is(input,textarea):focus + .hint{ top:100%; transform:translateY(3px); opacity:.85; }
    .field:has(select) .hint{ top:100%; transform:translateY(3px); opacity:.85; }
    .field select{ appearance:auto; line-height:1.2; }

    /* Error styles */
    .field.error input,
    .field.error select,
    .field.error textarea{
      border-color:var(--err);
      box-shadow:0 0 0 2px var(--err-bg) inset;
    }
    .err{
      position:absolute; top:100%; left:0; transform:translateY(6px);
      font-size:12px; color:var(--err);
      display:flex; align-items:center; gap:6px;
    }
    .err::before{ content:"‚ö†"; font-size:14px; line-height:1; }

    .subtle .row-title{font-weight:500}

    .signature-block{margin-top:auto}
    .sig-col{display:flex;flex-direction:column;gap:4px}
    .line.signature{border-bottom:var(--hairline) solid var(--hair);height:28px}
    .sig-label{color:var(--ink-faint);font-size:var(--mini-size)}
    .oath{border-top:var(--rule) solid var(--border);padding-top:6px}
    .sig-pair{display:grid;grid-template-columns:1fr 1fr;gap:8px;align-items:end;margin-top:6px}
    .stamp{border:var(--hairline) dashed var(--hair);padding:8px 6px;min-height:44px}
    .line.registrar{border-bottom:var(--hairline) solid var(--hair);height:28px}

    /* Actions */
    .actions{display:flex;gap:10px;justify-content:flex-end;margin-top:14px;flex-wrap:wrap;}
    .actions button{padding:8px 14px;border:1px solid var(--border);font-size:13px;cursor:pointer;background:#f7f7f7;}
    .actions .submit{background:#222;color:#fff}
    @media (max-width:480px){ .actions button{flex:1; min-width:140px;} }

    /* Print */
    @media print{
      :root{--title-size:22pt;--label-size:10pt;--mini-size:9pt;--body-size:11pt;--rule:.8pt;--hairline:.5pt;}
      @page{ size:A4; margin:10mm; }
      body{background:#fff;box-shadow:none}
      .sheet{max-width:none;border:0;box-shadow:none;padding:0}
      .panel__title{background:#f2f2f2}
      .actions{display:none}
      .A4{aspect-ratio:210/297;}
    }
  </style>
</head>
<body>
<form id="marriageForm" class="sheet A4" role="main" novalidate>
  <header class="masthead">
    <div class="masthead__left">
      <div class="mini smallcaps">Municipal Form 90 (Form No. 2)</div>
      <div class="mini">Revised January 2007</div>
    </div>
    <div class="masthead__center">
      <div class="gov smallcaps">Republic of the Philippines</div>
      <div class="office smallcaps">OFFICE OF THE CIVIL REGISTRAR GENERAL</div>
      <h1 class="title">APPLICATION FOR MARRIAGE LICENSE</h1>
    </div>
    <div class="masthead__right">
      <div class="mini">To be accomplished in quadruplicate using black ink</div>
    </div>
  </header>

  <!-- META -->
  <section class="meta-grid" aria-label="Form metadata">
    <div class="meta"><label for="province">Province</label><input id="province" name="province" required></div>
    <div class="meta"><label for="citymun">City/Municipality</label><input id="citymun" name="citymun" required></div>
    <div class="meta"><label for="receivedby">Received by</label><input id="receivedby" name="receivedby" required></div>
    <div class="meta"><label for="dateofreceipt">Date of Receipt</label><input id="dateofreceipt" name="dateofreceipt" type="date" required></div>
    <div class="meta"><label for="regno">Registry No.</label><input id="regno" name="regno" required></div>
    <div class="meta"><label for="mlno">Marriage License No.</label><input id="mlno" name="mlno" required></div>
    <div class="meta"><label for="issuedate">Date of Issuance of Marriage License</label><input id="issuedate" name="issuedate" type="date" required></div>
  </section>

  <section class="twocol" aria-label="Applicants">
    <!-- GROOM PANEL -->
    <div class="panel" aria-labelledby="groom-title">
      <div id="groom-title" class="panel__title">GROOM</div>
      <div class="registrar-note">
        <div class="smallcaps">The Civil Registrar</div>
        <p class="mini">Sir/Madam:</p>
        <p class="mini just">
          May I apply for a license to contract marriage with ______ and to this effect,
          being duly sworn, I hereby depose and say that I have all the necessary
          qualifications and none of the legal disqualifications to contract the said
          marriage, and that the following data are true and correct to the best of my
          knowledge and information:
        </p>
      </div>

      <ol class="fieldset">
        <li>
          <div class="row-title">1. Name of Applicant</div>
          <div class="grid-3 stack-on-mobile" aria-label="Name of Applicant">
            <div class="field"><input type="text" name="g_first" required aria-label="Groom First name"><span class="hint">(First)</span></div>
            <div class="field"><input type="text" name="g_middle" required aria-label="Groom Middle name"><span class="hint">(Middle)</span></div>
            <div class="field"><input type="text" name="g_last" required aria-label="Groom Last name"><span class="hint">(Last)</span></div>
          </div>
        </li>
        <li>
          <div class="row-title">2. Date of Birth/ Age</div>
          <div class="grid-4 stack-on-mobile" aria-label="Date of Birth and Age">
            <div class="field small"><input type="number" min="1" max="31" name="g_dob_day" required aria-label="Groom Day of birth"><span class="hint">(Day)</span></div>
            <div class="field small"><input type="text" name="g_dob_month" required aria-label="Groom Month of birth"><span class="hint">(Month)</span></div>
            <div class="field small"><input type="number" min="1900" max="2100" name="g_dob_year" required aria-label="Groom Year of birth"><span class="hint">(Year)</span></div>
            <div class="field small"><input type="number" min="1" max="150" name="g_age" required aria-label="Groom Age"><span class="hint">(Age)</span></div>
          </div>
        </li>
        <li>
          <div class="row-title">3. Place of Birth</div>
          <div class="grid-3 stack-on-mobile" aria-label="Place of Birth">
            <div class="field"><input type="text" name="g_pob_city" required><span class="hint">(City/Municipality)</span></div>
            <div class="field"><input type="text" name="g_pob_province" required><span class="hint">(Province)</span></div>
            <div class="field"><input type="text" name="g_pob_country" required><span class="hint">(Country)</span></div>
          </div>
        </li>
        <li>
          <div class="row-title">4. Sex/ Citizenship</div>
          <div class="grid-2 stack-on-mobile" aria-label="Sex and Citizenship">
            <div class="field small">
              <select name="g_sex" required aria-label="Groom Sex">
                <option value="" disabled selected>‚Äî Select ‚Äî</option>
                <option>Male</option>
                <option>Female</option>
              </select>
              <span class="hint">(Male/Female)</span>
            </div>
            <div class="field"><input type="text" name="g_citizenship" required aria-label="Groom Citizenship"><span class="hint">(Citizenship)</span></div>
          </div>
        </li>
        <li>
          <div class="row-title">5. Residence</div>
          <div class="grid-1" aria-label="Residence">
            <div class="field"><input type="text" name="g_residence" required><span class="hint">(House No., St., Barangay, City/Municipality, Province, Country)</span></div>
          </div>
        </li>
        <li>
          <div class="row-title">6. Religion/ Religious Sect</div>
          <div class="grid-1"><div class="field"><input type="text" name="g_religion" required></div></div>
        </li>
        <li>
          <div class="row-title">7. Civil Status</div>
          <div class="grid-1"><div class="field"><input type="text" name="g_civil_status" required></div></div>
        </li>
        <li>
          <div class="row-title">8. IF PREVIOUSLY MARRIED: How was it dissolved?</div>
          <div class="grid-1"><div class="field"><input type="text" name="g_dissolution" required></div></div>
        </li>
        <li>
          <div class="row-title">9. Place where dissolved</div>
          <div class="grid-3 stack-on-mobile">
            <div class="field"><input type="text" name="g_diss_city" required><span class="hint">(City/Municipality)</span></div>
            <div class="field"><input type="text" name="g_diss_province" required><span class="hint">(Province)</span></div>
            <div class="field"><input type="text" name="g_diss_country" required><span class="hint">(Country)</span></div>
          </div>
        </li>
        <li>
          <div class="row-title">10. Date when dissolved</div>
          <div class="grid-3 stack-on-mobile">
            <div class="field small"><input type="number" min="1" max="31" name="g_diss_day" required><span class="hint">(Day)</span></div>
            <div class="field small"><input type="text" name="g_diss_month" required><span class="hint">(Month)</span></div>
            <div class="field small"><input type="number" min="1900" max="2100" name="g_diss_year" required><span class="hint">(Year)</span></div>
          </div>
        </li>
        <li class="subtle">
          <div class="row-title">11. Degree of relationship of contracting parties</div>
          <div class="grid-1"><div class="field"><input type="text" name="g_relationship_degree" required></div></div>
        </li>
        <li>
          <div class="row-title">12. Name of Father</div>
          <div class="grid-3 stack-on-mobile">
            <div class="field"><input type="text" name="g_father_first" required><span class="hint">(First)</span></div>
            <div class="field"><input type="text" name="g_father_mid" required><span class="hint">(Middle)</span></div>
            <div class="field"><input type="text" name="g_father_last" required><span class="hint">(Last)</span></div>
          </div>
        </li>
        <li>
          <div class="row-title">13. Citizenship</div>
          <div class="grid-1"><div class="field"><input type="text" name="g_father_citizenship" required></div></div>
        </li>
        <li>
          <div class="row-title">14. Residence</div>
          <div class="grid-1"><div class="field"><input type="text" name="g_father_residence" required><span class="hint">(House No., St., Barangay, City/Municipality, Province, Country)</span></div></div>
        </li>
        <li>
          <div class="row-title">15. Maiden Name of Mother</div>
          <div class="grid-3 stack-on-mobile">
            <div class="field"><input type="text" name="g_mother_first" required><span class="hint">(First)</span></div>
            <div class="field"><input type="text" name="g_mother_mid" required><span class="hint">(Middle)</span></div>
            <div class="field"><input type="text" name="g_mother_last" required><span class="hint">(Last)</span></div>
          </div>
        </li>
        <li>
          <div class="row-title">16. Citizenship</div>
          <div class="grid-1"><div class="field"><input type="text" name="g_mother_citizenship" required></div></div>
        </li>
        <li>
          <div class="row-title">17. Residence</div>
          <div class="grid-1"><div class="field"><input type="text" name="g_mother_residence" required><span class="hint">(House No., St., Barangay, City/Municipality, Province, Country)</span></div></div>
        </li>
        <li>
          <div class="row-title">18. Persons who gave consent or advice</div>
          <div class="grid-1"><div class="field"><input type="text" name="g_consent_persons" required></div></div>
        </li>
        <li>
          <div class="row-title">19. Relationship</div>
          <div class="grid-1"><div class="field"><input type="text" name="g_consent_relationship" required></div></div>
        </li>
        <li>
          <div class="row-title">20. Citizenship</div>
          <div class="grid-1"><div class="field"><input type="text" name="g_consent_citizenship" required></div></div>
        </li>
        <li>
          <div class="row-title">21. Residence</div>
          <div class="grid-1"><div class="field"><input type="text" name="g_consent_residence" required><span class="hint">(House No., St., Barangay, City/Municipality, Province, Country)</span></div></div>
        </li>
      </ol>

      <div class="signature-block" aria-label="Signature section">
        <div class="sig-col">
          <div class="line signature"></div>
          <div class="sig-label mini">Signature of Applicant</div>
          <div class="oath">
            <div class="smallcaps center">SUBSCRIBED AND SWORN</div>
            <p class="mini just">
              to before me this ______ day of ____________ at _____________, Philippines, affiant who
              exhibited to me his Community Tax Cert. __________ issued on __________ at __________.
            </p>
            <div class="sig-pair">
              <div class="stamp mini">Exempt from documentary stamp tax</div>
              <div class="line registrar"></div>
            </div>
            <div class="sig-label mini right">(Signature Over Printed Name of the Civil Registrar)</div>
          </div>
        </div>
      </div>
    </div>

    <!-- BRIDE PANEL -->
    <div class="panel" aria-labelledby="bride-title">
      <div id="bride-title" class="panel__title">BRIDE</div>
      <div class="registrar-note">
        <div class="smallcaps">The Civil Registrar</div>
        <p class="mini">Sir/Madam:</p>
        <p class="mini just">
          May I apply for a license to contract marriage with ______ and to this effect,
          being duly sworn, I hereby depose and say that I have all the necessary
          qualifications and none of the legal disqualifications to contract the said
          marriage, and that the following data are true and correct to the best of my
          knowledge and information:
        </p>
      </div>

      <ol class="fieldset">
        <li>
          <div class="row-title">1. Name of Applicant</div>
          <div class="grid-3 stack-on-mobile">
            <div class="field"><input type="text" name="b_first" required aria-label="Bride First name"><span class="hint">(First)</span></div>
            <div class="field"><input type="text" name="b_middle" required aria-label="Bride Middle name"><span class="hint">(Middle)</span></div>
            <div class="field"><input type="text" name="b_last" required aria-label="Bride Last name"><span class="hint">(Last)</span></div>
          </div>
        </li>
        <li>
          <div class="row-title">2. Date of Birth/ Age</div>
          <div class="grid-4 stack-on-mobile">
            <div class="field small"><input type="number" min="1" max="31" name="b_dob_day" required><span class="hint">(Day)</span></div>
            <div class="field small"><input type="text" name="b_dob_month" required><span class="hint">(Month)</span></div>
            <div class="field small"><input type="number" min="1900" max="2100" name="b_dob_year" required><span class="hint">(Year)</span></div>
            <div class="field small"><input type="number" min="1" max="150" name="b_age" required><span class="hint">(Age)</span></div>
          </div>
        </li>
        <li>
          <div class="row-title">3. Place of Birth</div>
          <div class="grid-3 stack-on-mobile">
            <div class="field"><input type="text" name="b_pob_city" required><span class="hint">(City/Municipality)</span></div>
            <div class="field"><input type="text" name="b_pob_province" required><span class="hint">(Province)</span></div>
            <div class="field"><input type="text" name="b_pob_country" required><span class="hint">(Country)</span></div>
          </div>
        </li>
        <li>
          <div class="row-title">4. Sex/ Citizenship</div>
          <div class="grid-2 stack-on-mobile">
            <div class="field small">
              <select name="b_sex" required aria-label="Bride Sex">
                <option value="" disabled selected>‚Äî Select ‚Äî</option>
                <option>Male</option>
                <option>Female</option>
              </select>
              <span class="hint">(Male/Female)</span>
            </div>
            <div class="field"><input type="text" name="b_citizenship" required><span class="hint">(Citizenship)</span></div>
          </div>
        </li>
        <li>
          <div class="row-title">5. Residence</div>
          <div class="grid-1">
            <div class="field"><input type="text" name="b_residence" required><span class="hint">(House No., St., Barangay, City/Municipality, Province, Country)</span></div>
          </div>
        </li>
        <li>
          <div class="row-title">6. Religion/ Religious Sect</div>
          <div class="grid-1"><div class="field"><input type="text" name="b_religion" required></div></div>
        </li>
        <li>
          <div class="row-title">7. Civil Status</div>
          <div class="grid-1"><div class="field"><input type="text" name="b_civil_status" required></div></div>
        </li>
        <li>
          <div class="row-title">8. IF PREVIOUSLY MARRIED: How was it dissolved?</div>
          <div class="grid-1"><div class="field"><input type="text" name="b_dissolution" required></div></div>
        </li>
        <li>
          <div class="row-title">9. Place where dissolved</div>
          <div class="grid-3 stack-on-mobile">
            <div class="field"><input type="text" name="b_diss_city" required><span class="hint">(City/Municipality)</span></div>
            <div class="field"><input type="text" name="b_diss_province" required><span class="hint">(Province)</span></div>
            <div class="field"><input type="text" name="b_diss_country" required><span class="hint">(Country)</span></div>
          </div>
        </li>
        <li>
          <div class="row-title">10. Date when dissolved</div>
          <div class="grid-3 stack-on-mobile">
            <div class="field small"><input type="number" min="1" max="31" name="b_diss_day" required><span class="hint">(Day)</span></div>
            <div class="field small"><input type="text" name="b_diss_month" required><span class="hint">(Month)</span></div>
            <div class="field small"><input type="number" min="1900" max="2100" name="b_diss_year" required><span class="hint">(Year)</span></div>
          </div>
        </li>
        <li class="subtle">
          <div class="row-title">11. Degree of relationship of contracting parties</div>
          <div class="grid-1"><div class="field"><input type="text" name="b_relationship_degree" required></div></div>
        </li>
        <li>
          <div class="row-title">12. Name of Father</div>
          <div class="grid-3 stack-on-mobile">
            <div class="field"><input type="text" name="b_father_first" required><span class="hint">(First)</span></div>
            <div class="field"><input type="text" name="b_father_mid" required><span class="hint">(Middle)</span></div>
            <div class="field"><input type="text" name="b_father_last" required><span class="hint">(Last)</span></div>
          </div>
        </li>
        <li>
          <div class="row-title">13. Citizenship</div>
          <div class="grid-1"><div class="field"><input type="text" name="b_father_citizenship" required></div></div>
        </li>
        <li>
          <div class="row-title">14. Residence</div>
          <div class="grid-1"><div class="field"><input type="text" name="b_father_residence" required><span class="hint">(House No., St., Barangay, City/Municipality, Province, Country)</span></div></div>
        </li>
        <li>
          <div class="row-title">15. Maiden Name of Mother</div>
          <div class="grid-3 stack-on-mobile">
            <div class="field"><input type="text" name="b_mother_first" required><span class="hint">(First)</span></div>
            <div class="field"><input type="text" name="b_mother_mid" required><span class="hint">(Middle)</span></div>
            <div class="field"><input type="text" name="b_mother_last" required><span class="hint">(Last)</span></div>
          </div>
        </li>
        <li>
          <div class="row-title">16. Citizenship</div>
          <div class="grid-1"><div class="field"><input type="text" name="b_mother_citizenship" required></div></div>
        </li>
        <li>
          <div class="row-title">17. Residence</div>
          <div class="grid-1"><div class="field"><input type="text" name="b_mother_residence" required><span class="hint">(House No., St., Barangay, City/Municipality, Province, Country)</span></div></div>
        </li>
        <li>
          <div class="row-title">18. Persons who gave consent or advice</div>
          <div class="grid-1"><div class="field"><input type="text" name="b_consent_persons" required></div></div>
        </li>
        <li>
          <div class="row-title">19. Relationship</div>
          <div class="grid-1"><div class="field"><input type="text" name="b_consent_relationship" required></div></div>
        </li>
        <li>
          <div class="row-title">20. Citizenship</div>
          <div class="grid-1"><div class="field"><input type="text" name="b_consent_citizenship" required></div></div>
        </li>
        <li>
          <div class="row-title">21. Residence</div>
          <div class="grid-1"><div class="field"><input type="text" name="b_consent_residence" required><span class="hint">(House No., St., Barangay, City/Municipality, Province, Country)</span></div></div>
        </li>
      </ol>

      <div class="signature-block" aria-label="Signature section">
        <div class="sig-col">
          <div class="line signature"></div>
          <div class="sig-label mini">Signature of Applicant</div>
          <div class="oath">
            <div class="smallcaps center">SUBSCRIBED AND SWORN</div>
            <p class="mini just">
              to before me this ______ day of ____________ at _____________, Philippines, affiant who
              exhibited to me his Community Tax Cert. __________ issued on __________ at __________.
            </p>
            <div class="sig-pair">
              <div class="stamp mini">Exempt from documentary stamp tax</div>
              <div class="line registrar"></div>
            </div>
            <div class="sig-label mini right">(Signature Over Printed Name of the Civil Registrar)</div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Buttons bottom-right -->
  <div class="actions">
    <button type="reset" class="reset">Reset</button>
    <button type="submit" class="submit">Submit</button>
  </div>
</form>

<script>

  // --- Error helpers ---
  function clearError(field){
    field.classList.remove('error');
    const msg = field.querySelector('.err');
    if(msg) msg.remove();
    const ctl = field.querySelector('input,select,textarea');
    if(ctl) ctl.removeAttribute('aria-invalid');
  }

  function showError(field, text='Fill this field'){
    if(field.querySelector('.err')) return; // already has one
    field.classList.add('error');
    const ctl = field.querySelector('input,select,textarea');
    if(ctl) ctl.setAttribute('aria-invalid','true');
    const div = document.createElement('div');
    div.className = 'err';
    div.role = 'alert';
    div.textContent = text;
    field.appendChild(div);
  }

  function validateForm(form){
    let firstInvalid = null;
    // clear previous
    form.querySelectorAll('.field').forEach(clearError);

    // check required controls
    const ctrls = form.querySelectorAll('.field input[required], .field select[required], .field textarea[required]');
    ctrls.forEach(ctrl=>{
      const field = ctrl.closest('.field');
      const val = (ctrl.tagName === 'SELECT') ? (ctrl.value||'') : (ctrl.value||'').trim();
      if(val === ''){
        if(!firstInvalid) firstInvalid = ctrl;
        showError(field);
      }
    });
    return firstInvalid;
  }

  const form = document.getElementById('marriageForm');
  const inputs = form.querySelectorAll('.field input, .field select, .field textarea');

  inputs.forEach(el=>{
    syncFieldState(el); // initial
    el.addEventListener('input', ()=>{
      syncFieldState(el);
      // live clear errors when valid
      const field = el.closest('.field');
      const val = (el.tagName === 'SELECT') ? (el.value||'') : (el.value||'').trim();
      if(val !== '') clearError(field);
    });
    el.addEventListener('change', ()=>{
      syncFieldState(el);
      const field = el.closest('.field');
      const val = (el.tagName === 'SELECT') ? (el.value||'') : (el.value||'').trim();
      if(val !== '') clearError(field);
    });
    el.addEventListener('blur',  ()=>syncFieldState(el));
    el.addEventListener('focus', ()=>syncFieldState(el));
  });

  form.addEventListener('submit', (e)=>{
    const firstInvalid = validateForm(form);
    if(firstInvalid){
      e.preventDefault();
      firstInvalid.scrollIntoView({behavior:'smooth', block:'center'});
      firstInvalid.focus({preventScroll:true});
    } else {
      // form is complete; proceed (replace with your real submit if needed)
      alert('All fields complete. Submitting form‚Ä¶');
    }
  });

  form.addEventListener('reset', ()=>{
    setTimeout(()=>{
      form.querySelectorAll('.field').forEach(clearError);
      inputs.forEach(syncFieldState);
    },0);
  });
</script>
</body>
</html>

</template>
 

<script>

  document.addEventListener('click', (e)=>{
  const cam = e.target.closest('.dr-view');
  if(cam){
    e.preventDefault();
    // Future logic here ‚Äî e.g., open file input or camera API
    alert('Open camera or attach file here');
  }
});

 const fileInput = document.getElementById('fileInput');
  fileInput.addEventListener('change', () => {
    if (fileInput.files.length > 0) {
      alert('File attached: ' + fileInput.files[0].name);
    }
  });

  document.addEventListener('click', (e) => {
    const openBtn = e.target.closest('[data-open]');
    if (openBtn) {
      const id = openBtn.getAttribute('data-open');
      const dlg = document.getElementById(id);
      if (dlg && typeof dlg.showModal === 'function') dlg.showModal();
    }
    if (e.target.matches('[data-close]')) {
      const dlg = e.target.closest('dialog');
      if (dlg) dlg.close();
    }
  });

  /* =======================================
     Approve / Revise (with note) per item
     ======================================= */
  document.addEventListener('click', (e) => {
    // Approve
    const approveBtn = e.target.closest('[data-approve]');
    if (approveBtn) {
      approveBtn.textContent = 'Approved';
      approveBtn.disabled = true;
      const actionsRow = approveBtn.closest('.actions-inline');
      const reviseBtn = actionsRow?.querySelector('[data-revise]');
      if (reviseBtn) reviseBtn.disabled = true;
      return;
    }

    // Show note form
    const reviseBtn = e.target.closest('[data-revise]');
    if (reviseBtn) {
      const li = reviseBtn.closest('li, .req-tr');
      const form = li.querySelector('.note-form');
      if (form) { form.hidden = false; reviseBtn.disabled = true; }
      return;
    }

    // Send revision
    const sendBtn = e.target.closest('[data-send-revision]');
    if (sendBtn) {
      e.preventDefault();
      const form = sendBtn.closest('.note-form');
      const textarea = form.querySelector('.note-input');
      const note = textarea.value.trim();
      if (!note) { textarea.focus(); textarea.placeholder = 'Please add a short note before sending‚Ä¶'; return; }
      sendBtn.textContent = 'Revision Sent';
      sendBtn.disabled = true;
      const li = sendBtn.closest('li, .req-tr');
      li.querySelectorAll('[data-approve],[data-revise]').forEach(b => b.disabled = true);
      return;
    }
  });

  /* =======================================
     Auto-update row Status from dialog state
     ======================================= */
  function makeBadge(type, text) {
    const span = document.createElement('span');
    span.className = 'badge';
    if (type === 'ok') span.classList.add('ok');
    if (type === 'pending') span.classList.add('pending');
    if (type === 'reject') span.classList.add('reject');
    span.textContent = text;
    return span;
  }
  function renderStatus(container, type, text) {
    if (!container) return;
    container.innerHTML = '';
    container.appendChild(makeBadge(type, text));
  }
  function computeDialogStatus(dlg) {
    const items = dlg.querySelectorAll('.req-tr, li');
    let approved = 0, revised = 0, total = 0;
    items.forEach(item => {
      total++;
      const approveBtn = item.querySelector('[data-approve]');
      const reviseBtn  = item.querySelector('[data-revise]');
      const sendBtn    = item.querySelector('[data-send-revision]');
      const noteForm   = item.querySelector('.note-form');
      const isApproved = !!(approveBtn?.disabled && /approved/i.test(approveBtn.textContent));
      const sentRevision = !!(sendBtn?.disabled && /revision sent/i.test(sendBtn.textContent));
      const requestedRevision = !!(reviseBtn?.disabled && noteForm && !noteForm.hidden);
      if (isApproved) approved++; else if (sentRevision || requestedRevision) revised++;
    });
    return { total, approved, revised };
  }
  function findRowForDialog(dlg) {
    const opener = document.querySelector(`[data-open="${dlg.id}"]`);
    return opener ? opener.closest('tr') : null;
  }
  function updateStatusFromDialog(dlg) {
    const row = findRowForDialog(dlg);
    if (!row) return;
    const { total, approved, revised } = computeDialogStatus(dlg);
    let type = 'pending', text = 'Pending';
    if (total > 0 && approved === total) { type = 'ok'; text = 'Approved'; }
    else if (revised > 0) { type = 'reject'; text = 'Revision Required'; }
    const statusDiv = row.querySelector('[data-status]');
    renderStatus(statusDiv, type, text);
    // Optional: mirror to Final Status
    const finalDiv = row.querySelector('[data-status-final]');
    if (finalDiv) renderStatus(finalDiv, type, text);
  }
  document.addEventListener('click', (e) => {
    if (
      e.target.closest('[data-approve]') ||
      e.target.closest('[data-revise]') ||
      e.target.closest('[data-send-revision]')
    ) {
      const dlg = e.target.closest('dialog');
      if (dlg) setTimeout(() => updateStatusFromDialog(dlg), 50);
    }
  });
  document.addEventListener('close', (e) => {
    if (e.target instanceof HTMLDialogElement) updateStatusFromDialog(e.target);
  }, true);

  /* =======================================
     View Registration Form (iframe loader)
     ======================================= */
  function getTemplateHTML(tpl) {
    let html = (tpl.innerHTML || "").trim();
    if (!html && tpl.content) {
      html = new XMLSerializer().serializeToString(tpl.content.cloneNode(true));
    }
    return html;
  }
  function injectIntoIframe(frame, html) {
    frame.srcdoc = html;
    const onLoad = () => {
      try {
        const doc = frame.contentDocument || frame.contentWindow?.document;
        const isBlank = !doc || !doc.body || !doc.body.childElementCount;
        if (isBlank) { doc.open(); doc.write(html); doc.close(); }
      } catch (e) {
        console.warn('Iframe fallback write failed:', e);
      } finally {
        frame.removeEventListener('load', onLoad);
      }
    };
    frame.addEventListener('load', onLoad);
  }
  document.addEventListener('click', (e) => {
    const trigger = e.target.closest('[data-open-form]');
    if (trigger) {
      e.preventDefault();
      const dlg = document.getElementById(trigger.getAttribute('data-open-form'));
      const frame = dlg?.querySelector('iframe');
      const tpl  = document.getElementById('birth-form-template');
      if (frame && tpl) {
        const html = getTemplateHTML(tpl);
        injectIntoIframe(frame, html);
      }
      dlg?.showModal();
    }
    if (e.target.matches('[data-close]')) {
      e.target.closest('dialog')?.close();
    }
    if (e.target.matches('[data-print]')) {
      const frame = e.target.closest('dialog')?.querySelector('iframe');
      frame?.contentWindow?.focus();
      frame?.contentWindow?.print();
    }
  });

  // Typewriter init
  document.addEventListener('DOMContentLoaded', () => {
    document.querySelectorAll('.typewriter').forEach(el => {
      const text = el.textContent.trim();
      el.style.setProperty('--tw-chars', text.length);
      el.style.setProperty('--tw-duration', Math.max(1.8, text.length * 0.065) + 's');
      el.classList.add('animating');
      el.addEventListener('animationend', (e) => {
        if (e.animationName === 'typing') el.style.borderRight = 'none';
      });
    });
  });

  /* ===========================
     Live search filter (NEW)
     =========================== */
  (function(){
    const tbody = document.getElementById('val-body');
    const empty = document.getElementById('val-empty');
    const search = document.getElementById('val-search');
    if(!tbody || !empty || !search) return;

    function runFilter(){
      const q = (search.value || '').trim().toLowerCase();
      let shown = 0;
      [...tbody.querySelectorAll('tr')].forEach(tr=>{
        // Collect searchable content: name + muted lines + maybe actions labels
        const hay = tr.textContent.toLowerCase();
        const match = hay.includes(q);
        tr.style.display = match ? '' : 'none';
        if(match) shown++;
      });
      empty.style.display = shown === 0 ? '' : 'none';
    }
    search.addEventListener('input', runFilter);
    runFilter();
  })();
</script>

<footer class="footer">
  <p>¬© 2025 Civil Registry Management | Ensuring accuracy and integrity of records</p>
</footer>
</body>
</html>
